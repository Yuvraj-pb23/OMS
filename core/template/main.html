<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus | Office Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            /* Professional Dark Navy & Cool Grey Palette */
            --primary: #0f172a;
            --primary-light: #1e293b;
            --secondary: #334155;

            /* Vibrant but Professional Accents */
            --accent: #3b82f6;
            /* Royal Blue */
            --accent-gradient: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            --accent-glow: rgba(59, 130, 246, 0.4);

            /* Status Colors */
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;

            /* Text Colors */
            --text-main: #1e293b;
            --text-dim: #64748b;
            --text-light: #f8fafc;

            /* Glass & Cards */
            --card-bg: rgba(255, 255, 255, 0.85);
            --glass-border: 1px solid rgba(255, 255, 255, 0.6);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.05);

            /* Dimensions */
            --sidebar-width: 260px;
            --sidebar-collapsed: 80px;
            --transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            /* Modern Professional Gradient Background */
            background: radial-gradient(circle at 10% 20%, rgb(239, 246, 255) 0%, rgb(241, 245, 249) 90%);
            color: var(--text-main);
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* --- ANIMATIONS --- */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(15px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse-glow {
            0% {
                box-shadow: 0 0 0 0 var(--accent-glow);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
            }
        }

        /* Cursor Animation for Typewriter */
        @keyframes blinkCursor {
            from {
                border-right-color: var(--accent);
            }

            to {
                border-right-color: transparent;
            }
        }

        /* --- SIDEBAR --- */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--primary);
            background-image: linear-gradient(180deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0) 100%);
            color: white;
            height: 100vh;
            position: fixed;
            transition: var(--transition);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            box-shadow: 4px 0 24px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
        }

        .sidebar.collapsed {
            width: var(--sidebar-collapsed);
        }

        .sidebar-header {
            height: 80px;
            display: flex;
            align-items: center;
            padding: 0 25px;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .sidebar-menu {
            padding: 20px 10px;
            flex: 1;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            color: #94a3b8;
            text-decoration: none;
            transition: var(--transition);
            border-radius: 12px;
            margin-bottom: 5px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .sidebar-menu a:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .sidebar-menu a.active {
            color: white;
            background: var(--accent-gradient);
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);
        }

        .sidebar-menu i {
            font-size: 1.2rem;
            min-width: 35px;
            text-align: center;
        }

        .sidebar.collapsed span {
            display: none;
        }

        /* --- MAIN CONTENT --- */
        .main-container {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
        }

        .sidebar.collapsed+.main-container {
            margin-left: var(--sidebar-collapsed);
        }

        header {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            height: 80px;
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 900;
            border-bottom: 1px solid rgba(226, 232, 240, 0.8);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.02);
        }

        .search-bar {
            background: white;
            border: 1px solid #cbd5e1;
            border-radius: 50px;
            /* Fully rounded */
            padding: 10px 20px;
            width: 400px;
            display: flex;
            align-items: center;
            transition: var(--transition);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.02);
        }

        .search-bar:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.15);
            width: 420px;
        }

        .search-bar input {
            background: transparent;
            border: none;
            outline: none;
            width: 100%;
            padding-left: 12px;
            color: var(--text-main);
            font-size: 0.95rem;
        }

        .content-padding {
            padding: 30px 40px;
        }

        /* --- STATS GRID --- */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            padding: 25px;
            border-radius: 24px;
            border: var(--glass-border);
            box-shadow: var(--glass-shadow);
            position: relative;
            overflow: hidden;
            transition: var(--transition);
            /* Initial state for JS animation */
            opacity: 0;
            transform: translateY(20px);
        }

        .stat-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
            border-color: white;
        }

        /* Decorative circle in stat card */
        .stat-card::before {
            content: '';
            position: absolute;
            top: -50px;
            right: -50px;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, var(--accent-glow) 0%, transparent 70%);
            border-radius: 50%;
            opacity: 0.3;
            transition: var(--transition);
        }

        .stat-card:hover::before {
            transform: scale(1.2);
            opacity: 0.5;
        }

        .stat-val {
            font-size: 2.2rem;
            font-weight: 800;
            margin: 12px 0;
            color: var(--primary);
            letter-spacing: -1px;
        }

        .stat-label {
            color: var(--text-dim);
            font-size: 0.85rem;
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        /* --- AI CARD STYLES --- */
        .ai-styled-section {
            background: linear-gradient(120deg, #eff6ff 0%, #ffffff 100%);
            border: 1px solid #dbeafe;
            border-radius: 24px;
            padding: 30px;
            display: flex;
            gap: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.1);
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.8s ease-out;
        }

        .ai-styled-section::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--accent);
        }

        .ai-icon-box {
            width: 55px;
            height: 55px;
            background: var(--accent-gradient);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.4rem;
            flex-shrink: 0;
            box-shadow: 0 8px 15px rgba(37, 99, 235, 0.3);
            animation: pulse-glow 3s infinite;
        }

        .ai-title {
            color: var(--primary);
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .ai-styled-list li {
            font-size: 1rem;
            color: var(--text-main);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 12px;
            border-radius: 8px;
            transition: var(--transition);
        }

        .ai-styled-list li:hover {
            background: rgba(255, 255, 255, 0.6);
            transform: translateX(5px);
        }

        .ai-btn-blue {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25);
        }

        .ai-btn-blue:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(37, 99, 235, 0.35);
        }

        .ai-btn-white {
            background: white;
            color: var(--secondary);
            border: 1px solid #e2e8f0;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
        }

        .ai-btn-white:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
            transform: translateY(-2px);
        }

        /* --- GLASS PANELS & TABLES --- */
        .glass-panel {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 24px;
            padding: 30px;
            box-shadow: var(--glass-shadow);
            border: var(--glass-border);
            margin-bottom: 25px;
            transition: var(--transition);
        }

        .glass-panel:hover {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.06);
        }

        .table-custom {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 10px;
        }

        .table-custom th {
            padding: 15px;
            text-align: left;
            color: var(--text-dim);
            font-weight: 700;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .table-custom tr td {
            padding: 18px 15px;
            background: white;
            transition: var(--transition);
            font-size: 0.9rem;
            border-top: 1px solid #f1f5f9;
            border-bottom: 1px solid #f1f5f9;
            color: var(--primary);
        }

        .table-custom tr td:first-child {
            border-radius: 16px 0 0 16px;
            border-left: 1px solid #f1f5f9;
        }

        .table-custom tr td:last-child {
            border-radius: 0 16px 16px 0;
            border-right: 1px solid #f1f5f9;
        }

        .table-custom tr:hover td {
            background: #f8fafc;
            transform: scale(1.01);
            border-color: #e2e8f0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.03);
            cursor: default;
        }

        /* Badges */
        .status-pill {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            display: inline-block;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .pending {
            background: #fee2e2;
            color: #ef4444;
        }

        .replied {
            background: #dcfce7;
            color: #10b981;
        }

        .forwarded {
            background: #dbeafe;
            color: #3b82f6;
        }

        .draft {
            background: #ffedd5;
            color: #f59e0b;
        }

        .open {
            background: #fee2e2;
            color: #ef4444;
        }

        .in-progress {
            background: #ffedd5;
            color: #f59e0b;
        }

        .resolved {
            background: #dcfce7;
            color: #10b981;
        }

        /* --- QUICK ACTIONS --- */
        .quick-btn-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .q-btn {
            background: white;
            border: 1px solid #e2e8f0;
            padding: 20px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.02);
            color: var(--secondary);
            font-weight: 600;
            font-size: 0.95rem;
        }

        .q-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
            background: white;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.15);
        }

        .q-btn i {
            font-size: 1.3rem;
            color: var(--accent);
            background: #eff6ff;
            padding: 10px;
            border-radius: 12px;
            transition: var(--transition);
        }

        .q-btn:hover i {
            background: var(--accent);
            color: white;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 25px;
            color: var(--primary);
            position: relative;
            display: inline-block;
        }

        /* --- BUTTONS --- */
        .btn-action {
            background: var(--accent-gradient);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .btn-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        /* --- DRAFTS & PROFILES (Interactive Cards) --- */
        .draft-big-card {
            background: white;
            border-radius: 24px;
            padding: 30px;
            box-shadow: var(--glass-shadow);
            border: 1px solid #e2e8f0;
            min-height: 350px;
            display: flex;
            flex-direction: column;
            transition: var(--transition);
        }

        .draft-big-card:hover {
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.08);
        }

        .draft-item {
            padding: 18px;
            background: #f8fafc;
            border-radius: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .draft-item:hover {
            border-color: var(--accent);
            background: #eff6ff;
            transform: translateX(5px);
        }

        .draft-item.active {
            background: var(--accent);
            color: white;
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
            transform: scale(1.02);
        }

        .draft-item.active p {
            color: #eff6ff;
        }

        /* --- PAGE TRANSITIONS --- */
        .page-view {
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .page-view.active {
            display: block;
            animation: fadeIn 0.5s forwards;
        }

        /* --- PROFILE GLASS CARDS --- */
        .glass-card {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            border-radius: 24px;
            padding: 25px;
            text-align: center;
            transition: var(--transition);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.05);
        }

        .glass-card:hover {
            transform: translateY(-8px);
            background: white;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.08);
            border-color: var(--accent);
        }

        .glass-avatar {
            width: 70px;
            height: 70px;
            background: var(--accent-gradient);
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.4rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        /* Cursor class for Typewriter */
        .typing-cursor::after {
            content: '|';
            display: inline-block;
            margin-left: 2px;
            color: var(--accent);
            animation: blinkCursor 0.7s infinite;
        }
    </style>
</head>

<body>
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <i class="fas fa-layer-group fa-2x text-accent" style="color: #60a5fa;"></i>
            <span style="margin-left: 15px; font-weight: 800; font-size: 1.2rem; letter-spacing: 0.5px;">Nexus OS</span>
        </div>
        <div class="sidebar-menu">
            <a onclick="showPage('dashboard-view')" class="active"><i class="fas fa-th-large"></i>
                <span>Dashboard</span></a>
            <a onclick="showPage('letters-view')"><i class="fas fa-envelope"></i> <span>Inbox</span></a>
            <a onclick="showPage('complaints-view')"><i class="fas fa-file-invoice"></i> <span>Complaints</span></a>
            <a onclick="showPage('reports-view')"><i class="fas fa-chart-pie"></i> <span>Analytics</span></a>
            <a href=""><i class="fas fa-cog"></i> <span>Settings</span></a>
        </div>
    </nav>

    <div class="main-container">
        <header>
            <div style="display: flex; align-items: center; gap: 20px;">
                <i class="fas fa-bars" style="cursor: pointer; color: var(--secondary); font-size: 1.2rem;"
                    onclick="toggleSidebar()"></i>
                <div class="search-bar">
                    <i class="fas fa-search text-dim"></i>
                    <input type="text" id="mainSearch" placeholder="Type to search..." onkeyup="filterContent()">
                </div>
            </div>
            <div style="display: flex; align-items: center; gap: 25px;">
                <div style="position: relative; cursor: pointer;">
                    <i class="far fa-bell fa-lg" style="color: var(--secondary);"></i>
                    <span
                        style="position: absolute; top: -5px; right: -5px; width: 10px; height: 10px; background: var(--danger); border-radius: 50%;"></span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                    <div style="text-align: right;">
                        <p style="font-size: 0.9rem; font-weight: 700;">Arjun Mehta</p>
                        <p style="font-size: 0.75rem; color: var(--text-dim);">Administrator</p>
                    </div>
                    <div
                        style="width: 45px; height: 45px; background: var(--accent-gradient); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                        AM</div>
                </div>
            </div>
        </header>

        <main class="content-padding">

            <!-- Dashboard View -->
            <div id="dashboard-view" class="page-view active">
                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <p class="stat-label">Total Letters</p>
                        <p class="stat-val">1,284</p>
                        <p style="color: var(--success); font-size: 0.85rem; font-weight: 600;"><i
                                class="fas fa-arrow-up"></i> 12% vs last month</p>
                    </div>
                    <div class="stat-card">
                        <p class="stat-label">Pending Replies</p>
                        <p class="stat-val" style="color: var(--danger);">43</p>
                        <p style="color: var(--text-dim); font-size: 0.85rem;">High Priority: 12</p>
                    </div>
                    <div class="stat-card">
                        <p class="stat-label">Active Cases</p>
                        <p class="stat-val">156</p>
                        <p style="color: var(--warning); font-size: 0.85rem;">3 expiring today</p>
                    </div>
                    <div class="stat-card">
                        <p class="stat-label">Avg. Response</p>
                        <p class="stat-val">1.2d</p>
                        <p style="color: var(--success); font-size: 0.85rem; font-weight: 600;">Top 5% efficiency</p>
                    </div>
                </div>

                <!-- Quick Actions Section -->
                <h3 class="section-title">Quick Actions</h3>
                <div class="quick-btn-grid">
                    <div class="q-btn" onclick="showPage('letters-view')"><i class="far fa-file-alt"></i> Register
                        Letter</div>
                    <div class="q-btn" onclick="showPage('complaints-view')"><i class="far fa-circle-exclamation"></i>
                        Register Complaint</div>
                    <div class="q-btn" onclick="showPage('drafts-view')"><i class="far fa-paper-plane"></i> Draft Reply
                    </div>
                    <div class="q-btn" onclick="showPage('forward-view')"><i class="fas fa-share"></i> Forward Letter
                    </div>
                    <div class="q-btn" onclick="showPage('reports-view')"><i class="fas fa-chart-bar"></i> View Reports
                    </div>
                </div>

                <!-- AI Insights -->
                <div class="ai-styled-section">
                    <div class="ai-icon-box">
                        <i class="fas fa-sparkles"></i>
                    </div>
                    <div style="flex: 1;">
                        <h3 class="ai-title">AI Insights & Recommendations </h3>
                        <ul class="ai-styled-list">
                            <li class="li-red"><i class="fas fa-circle" style="color: #ef4444; font-size: 8px;"></i> 5
                                letters pending reply for more than 5 days.</li>
                            <li class="li-orange"><i class="fas fa-circle" style="color: #f59e0b; font-size: 8px;"></i>
                                3 complaints need immediate action.</li>
                            <li class="li-blue"><i class="fas fa-circle" style="color: #3b82f6; font-size: 8px;"></i> 2
                                letters recommended for forwarding.</li>
                        </ul>
                        <div class="ai-button-group">
                            <button class="ai-btn-blue" onclick="showPage('letters-view')">
                                View Letters <i class="fas fa-arrow-right" style="font-size: 0.8rem;"></i>
                            </button>
                            <button class="ai-btn-white" onclick="showPage('complaints-view')">
                                View Complaints <i class="fas fa-arrow-right" style="font-size: 0.8rem;"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Tables Section -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                    <div class="glass-panel">
                        <div
                            style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 20px;">
                            <h3 style="margin:0;">Recent Letters</h3>
                            <i class="fas fa-ellipsis-h text-dim"></i>
                        </div>
                        <table class="table-custom">
                            <thead>
                                <tr>
                                    <th>Diary No</th>
                                    <th>Sender</th>
                                    <th>Subject</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>DRY-2024-1456</td>
                                    <td>Ministry of Finance</td>
                                    <td>Budget Allocation Query</td>
                                    <td><span class="status-pill pending">Pending</span></td>
                                    <td><i class="far fa-eye" style="color: var(--accent); cursor:pointer;"></i></td>
                                </tr>
                                <tr>
                                    <td>DRY-2024-1455</td>
                                    <td>Public Works Dept</td>
                                    <td>Infrastructure Plan</td>
                                    <td><span class="status-pill replied">Replied</span></td>
                                    <td><i class="far fa-eye" style="color: var(--accent); cursor:pointer;"></i></td>
                                </tr>
                                <tr>
                                    <td>DRY-2024-1454</td>
                                    <td>Education Dept</td>
                                    <td>School Building Approval</td>
                                    <td><span class="status-pill forwarded">Forwarded</span></td>
                                    <td><i class="far fa-eye" style="color: var(--accent); cursor:pointer;"></i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="glass-panel">
                        <div
                            style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 20px;">
                            <h3 style="margin:0;">Recent Complaints</h3>
                            <i class="fas fa-ellipsis-h text-dim"></i>
                        </div>
                        <table class="table-custom">
                            <thead>
                                <tr>
                                    <th>Complaint No</th>
                                    <th>Category</th>
                                    <th>Status</th>
                                    <th>Assigned To</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>CMP-2024-032</td>
                                    <td>Infrastructure</td>
                                    <td><span class="status-pill open">Open</span></td>
                                    <td>Vikram Singh</td>
                                </tr>
                                <tr>
                                    <td>CMP-2024-031</td>
                                    <td>Service Delay</td>
                                    <td><span class="status-pill in-progress">In Progress</span></td>
                                    <td>Anjali Desai</td>
                                </tr>
                                <tr>
                                    <td>CMP-2024-030</td>
                                    <td>Documentation</td>
                                    <td><span class="status-pill resolved">Resolved</span></td>
                                    <td>Rohan Gupta</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Performance and Deadlines -->
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 25px; margin-top: 10px;">
                    <div class="glass-panel" style="min-height: 350px; display: flex; flex-direction: column;">
                        <h3 style="margin-bottom: 20px;">Performance Overview</h3>
                        <div
                            style="flex: 1; display: flex; align-items: center; justify-content: center; border: 2px dashed #cbd5e1; border-radius: 15px; color: var(--text-dim); background: rgba(248, 250, 252, 0.5);">
                            <p><i class="fas fa-chart-line fa-2x"></i><br>Chart Placeholder</p>
                        </div>
                    </div>
                    <div class="glass-panel">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3>Upcoming Deadlines</h3>
                            <i class="far fa-calendar-alt text-dim"></i>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 15px;">
                            <div
                                style="background: #fff1f2; padding: 18px; border-radius: 16px; display: flex; align-items: flex-start; gap: 15px; border-left: 4px solid #e11d48;">
                                <i class="far fa-clock" style="color: #e11d48; margin-top: 3px;"></i>
                                <div style="flex: 1;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <span style="font-weight: 700; font-size: 0.9rem; color: #991b1b;">Reply
                                            Due</span>
                                        <span
                                            style="font-size: 0.75rem; color: #e11d48; font-weight:600;">2024-12-22</span>
                                    </div>
                                    <p style="font-size: 0.8rem; color: #ef4444; opacity: 0.9; margin-top: 4px;">Diary
                                        No. 1456</p>
                                </div>
                            </div>
                        </div>
                        <button
                            style="width: 100%; margin-top: 25px; padding: 14px; background: white; border: 1px solid #cbd5e1; border-radius: 12px; color: var(--accent); font-weight: 700; cursor: pointer; transition: 0.3s;">
                            View Full Calendar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Page: Register Letters -->
            <div id="letters-view" class="page-view">
                <button class="btn-action" style="margin-bottom: 20px; background: var(--secondary);"
                    onclick="showPage('dashboard-view')"><i class="fas fa-arrow-left"></i> Back</button>
                <div class="glass-panel">
                    <h3 class="section-title">Registered Letters Database</h3>
                    <table class="table-custom">
                        <thead>
                            <tr>
                                <th>Diary No</th>
                                <th>Sender</th>
                                <th>Subject</th>
                                <th>Received Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>DRY-2024-1456</td>
                                <td>Ministry of Finance</td>
                                <td>Budget Allocation Query</td>
                                <td>2024-12-01</td>
                                <td><span class="status-pill pending">Pending</span></td>
                            </tr>
                            <tr>
                                <td>DRY-2024-1455</td>
                                <td>Public Works Dept</td>
                                <td>Infrastructure Plan</td>
                                <td>2024-11-28</td>
                                <td><span class="status-pill replied">Replied</span></td>
                            </tr>
                            <tr>
                                <td>DRY-2024-1454</td>
                                <td>Education Dept</td>
                                <td>School Approval</td>
                                <td>2024-11-25</td>
                                <td><span class="status-pill forwarded">Forwarded</span></td>
                            </tr>
                            <tr>
                                <td>DRY-2024-1453</td>
                                <td>Health Dept</td>
                                <td>Medical Procurement</td>
                                <td>2024-11-20</td>
                                <td><span class="status-pill draft">Draft</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Page: Register Complaint -->
            <div id="complaints-view" class="page-view">
                <button class="btn-action" style="margin-bottom: 20px; background: var(--secondary);"
                    onclick="showPage('dashboard-view')"><i class="fas fa-arrow-left"></i> Back</button>
                <div class="glass-panel">
                    <h3 class="section-title">All Registered Complaints</h3>
                    <table class="table-custom">
                        <thead>
                            <tr>
                                <th>Complaint ID</th>
                                <th>Citizen Name</th>
                                <th>Category</th>
                                <th>Date Filed</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>CMP-2024-032</td>
                                <td>Vikram Singh</td>
                                <td>Infrastructure</td>
                                <td>2024-12-05</td>
                                <td><span class="status-pill open">Open</span></td>
                            </tr>
                            <tr>
                                <td>CMP-2024-031</td>
                                <td>Anjali Desai</td>
                                <td>Service Delay</td>
                                <td>2024-12-04</td>
                                <td><span class="status-pill in-progress">In Progress</span></td>
                            </tr>
                            <tr>
                                <td>CMP-2024-030</td>
                                <td>Rohan Gupta</td>
                                <td>Documentation</td>
                                <td>2024-12-03</td>
                                <td><span class="status-pill resolved">Resolved</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Page: Draft Reply -->
            <div id="drafts-view" class="page-view">
                <button class="btn-action" style="margin-bottom: 20px; background: var(--secondary);"
                    onclick="showPage('dashboard-view')"><i class="fas fa-arrow-left"></i> Back to Dashboard</button>

                <div class="draft-grid-layout" style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                    <!-- Card 1: All Drafts List -->
                    <div class="draft-big-card">
                        <h3 class="section-title"><i class="fas fa-list"></i> All Drafts</h3>
                        <div style="overflow-y: auto;">
                            <div class="draft-item active" onclick="loadDraft(0, this)">
                                <p style="font-weight: 700; font-size: 0.9rem;">Ref: DRY-2024-1456</p>
                                <p style="font-size: 0.75rem; color: var(--text-dim);">Subject: Budget Allocation
                                    Inquiry</p>
                            </div>
                            <div class="draft-item" onclick="loadDraft(1, this)">
                                <p style="font-weight: 700; font-size: 0.9rem;">Ref: CMP-2024-032</p>
                                <p style="font-size: 0.75rem; color: var(--text-dim);">Subject: Infrastructure Complaint
                                    Response</p>
                            </div>
                            <div class="draft-item" onclick="loadDraft(2, this)">
                                <p style="font-weight: 700; font-size: 0.9rem;">Ref: DRY-2024-1450</p>
                                <p style="font-size: 0.75rem; color: var(--text-dim);">Subject: Departmental Report
                                    Approval</p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 2: Summary -->
                    <div class="draft-big-card">
                        <h3 class="section-title"><i class="fas fa-file-alt"></i> Draft Summary</h3>
                        <div id="draft-summary" class="content-box"
                            style="line-height: 1.6; color: #475569; overflow-y: auto;">
                            <!-- Content loaded via JS -->
                        </div>
                    </div>

                    <!-- Card 3: Draft Content -->
                    <div class="draft-big-card">
                        <h3 class="section-title"><i class="fas fa-pen-nib"></i> Draft Content</h3>
                        <div id="draft-body" class="content-box"
                            style="line-height: 1.6; color: #475569; overflow-y: auto; white-space: pre-wrap;">
                            <!-- Content loaded via JS -->
                        </div>
                    </div>

                    <!-- Card 4: AI Reply -->
                    <div class="draft-big-card ai-reply-box"
                        style="background: linear-gradient(135deg, #eff6ff 0%, #f5f3ff 100%); border: 2px dashed #a5b4fc;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                            <span class="ai-badge"
                                style="margin:0; background: #6366f1; color: white; padding: 5px 10px; border-radius: 12px; font-size: 0.7rem; font-weight: bold;"><i
                                    class="fas fa-robot"></i> AI SUGGESTION</span>
                        </div>
                        <div class="content-box" style="background: transparent; min-height: 150px;">
                            <p id="ai-suggestion" class="typing-cursor"
                                style="font-style: italic; color: #4338ca; font-weight: 500; font-size: 0.95rem; line-height: 1.6;">
                                <!-- AI Typewriter text goes here -->
                            </p>
                        </div>
                        <button class="btn-action" style="margin-top: 20px; background: #6366f1;">Use This
                            Reply</button>
                    </div>
                </div>
            </div>

            <!-- Page: Forward Letter -->
            <div id="forward-view" class="page-view">
                <button class="btn-action" style="margin-bottom: 20px; background: var(--secondary);"
                    onclick="showPage('dashboard-view')"><i class="fas fa-arrow-left"></i> Back to Dashboard</button>

                <div class="draft-grid-layout" style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                    <!-- Card 1: Mailbox / Letters List -->
                    <div class="draft-big-card">
                        <h3 class="section-title"><i class="fas fa-inbox"></i> Select Letter</h3>
                        <div style="overflow-y: auto;">
                            <div class="draft-item"
                                onclick="selectLetter('DRY-2024-1456', 'Budget Allocation Query', this)">
                                <p style="font-weight: 700; font-size: 0.9rem;">Ref: DRY-2024-1456</p>
                                <p style="font-size: 0.75rem; color: var(--text-dim);">Subject: Budget Allocation Query
                                </p>
                            </div>
                            <div class="draft-item"
                                onclick="selectLetter('DRY-2024-1455', 'Infrastructure Plan', this)">
                                <p style="font-weight: 700; font-size: 0.9rem;">Ref: DRY-2024-1455</p>
                                <p style="font-size: 0.75rem; color: var(--text-dim);">Subject: Infrastructure Plan</p>
                            </div>
                            <div class="draft-item" onclick="selectLetter('DRY-2024-1454', 'School Approval', this)">
                                <p style="font-weight: 700; font-size: 0.9rem;">Ref: DRY-2024-1454</p>
                                <p style="font-size: 0.75rem; color: var(--text-dim);">Subject: School Approval</p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 2: User Profiles -->
                    <div class="draft-big-card">
                        <h3 class="section-title"><i class="fas fa-users-gear"></i> Forward To Profile</h3>
                        <div style="overflow-y: auto;">
                            <div class="draft-item"
                                onclick="selectProfile('Priya Kapoor', 'Public Works Head', 'PK', this)">
                                <div class="profile-list-item" style="display:flex; align-items:center; gap: 15px;">
                                    <div class="profile-pic"
                                        style="width:40px; height:40px; background:var(--accent); border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; font-weight:bold;">
                                        PK</div>
                                    <div>
                                        <p style="font-weight: 700; font-size: 0.9rem;">Priya Kapoor</p>
                                        <p style="font-size: 0.75rem; color: var(--text-dim);">Public Works Head</p>
                                    </div>
                                </div>
                            </div>
                            <div class="draft-item"
                                onclick="selectProfile('Rajesh Verma', 'Finance Officer', 'RV', this)">
                                <div class="profile-list-item" style="display:flex; align-items:center; gap: 15px;">
                                    <div class="profile-pic"
                                        style="width:40px; height:40px; background: var(--success); border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; font-weight:bold;">
                                        RV</div>
                                    <div>
                                        <p style="font-weight: 700; font-size: 0.9rem;">Rajesh Verma</p>
                                        <p style="font-size: 0.75rem; color: var(--text-dim);">Finance Officer</p>
                                    </div>
                                </div>
                            </div>
                            <div class="draft-item"
                                onclick="selectProfile('Sita Iyer', 'Education Director', 'SI', this)">
                                <div class="profile-list-item" style="display:flex; align-items:center; gap: 15px;">
                                    <div class="profile-pic"
                                        style="width:40px; height:40px; background: var(--warning); border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; font-weight:bold;">
                                        SI</div>
                                    <div>
                                        <p style="font-weight: 700; font-size: 0.9rem;">Sita Iyer</p>
                                        <p style="font-size: 0.75rem; color: var(--text-dim);">Education Director</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Long Card: Selection Summary & Action -->
                <div class="glass-panel"
                    style="margin-top: 25px; display: flex; align-items: center; justify-content: space-between; padding: 30px;">
                    <div style="display: flex; gap: 40px; align-items: center;">
                        <div id="display-letter" style="border-left: 4px solid var(--accent); padding-left: 15px;">
                            <p
                                style="font-size: 0.75rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px;">
                                Selected
                                Letter</p>
                            <p id="selected-letter-text" style="font-weight: 700; color: var(--primary);">None selected
                            </p>
                        </div>
                        <i class="fas fa-arrow-right text-dim"></i>
                        <div id="display-profile" style="border-left: 4px solid var(--success); padding-left: 15px;">
                            <p
                                style="font-size: 0.75rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px;">
                                Recipient
                                Profile</p>
                            <p id="selected-profile-text" style="font-weight: 700; color: var(--primary);">None selected
                            </p>
                        </div>
                    </div>
                    <button class="btn-action" style="padding: 15px 40px; font-size: 1rem;" onclick="confirmForward()">
                        <i class="fas fa-share-nodes"></i> &nbsp; Forward Letter Now
                    </button>
                </div>
            </div>

            <!-- Page: Reports View -->
            <div id="reports-view" class="page-view">
                <button class="btn-action" style="margin-bottom: 20px; background: var(--secondary);"
                    onclick="showPage('dashboard-view')"><i class="fas fa-arrow-left"></i> Back to Dashboard</button>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                    <!-- Bar Chart for Letters -->
                    <div class="glass-panel">
                        <h3 class="section-title">Letters Received (Monthly)</h3>
                        <canvas id="lettersBarChart" height="200"></canvas>
                    </div>

                    <!-- Line Chart (Letters & Complaints) -->
                    <div class="glass-panel">
                        <h3 class="section-title">Trend: Letters vs Complaints</h3>
                        <canvas id="trendLineChart" height="200"></canvas>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 25px; margin-top: 25px;">
                    <!-- Pie Chart for Solutions -->
                    <div class="glass-panel">
                        <h3 class="section-title">Solution Breakdown</h3>
                        <canvas id="solutionsPieChart" height="200"></canvas>
                    </div>

                    <!-- Team Profiles (Glassy Cards) -->
                    <div class="glass-panel">
                        <h3 class="section-title">Active Team Profiles</h3>
                        <div class="glass-profile-grid"
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            <div class="glass-card">
                                <div class="glass-avatar">AM</div>
                                <p style="font-weight: 700;">Arjun Mehta</p>
                                <p style="font-size: 0.75rem; color: var(--text-dim);">Administrator</p>
                            </div>
                            <div class="glass-card">
                                <div class="glass-avatar"
                                    style="background: linear-gradient(135deg, #10b981, #059669);">RV</div>
                                <p style="font-weight: 700;">Rajesh Verma</p>
                                <p style="font-size: 0.75rem; color: var(--text-dim);">Finance Officer</p>
                            </div>
                            <div class="glass-card">
                                <div class="glass-avatar"
                                    style="background: linear-gradient(135deg, #f59e0b, #d97706);">PK</div>
                                <p style="font-weight: 700;">Priya Kapoor</p>
                                <p style="font-size: 0.75rem; color: var(--text-dim);">Head of Works</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }

        function showPage(pageId) {
            const pages = document.querySelectorAll('.page-view');
            pages.forEach(page => page.classList.remove('active'));

            document.getElementById(pageId).classList.add('active');

            const links = document.querySelectorAll('.sidebar-menu a');
            links.forEach(link => link.classList.remove('active'));

            // Clear search when changing pages
            document.getElementById('mainSearch').value = "";
            filterContent();

            if (pageId === 'dashboard-view') links[0].classList.add('active');
            else if (pageId === 'letters-view') links[1].classList.add('active');
            else if (pageId === 'complaints-view') links[2].classList.add('active');
            else if (pageId === 'reports-view') {
                links[3].classList.add('active');
                initCharts();
            }
        }

        function filterContent() {
            const input = document.getElementById('mainSearch');
            const filter = input.value.toLowerCase();
            const activePage = document.querySelector('.page-view.active');

            const rows = activePage.querySelectorAll('.table-custom tbody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(filter) ? '' : 'none';
            });

            const listItems = activePage.querySelectorAll('.draft-item');
            listItems.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(filter) ? '' : 'none';
            });

            const quickBtns = activePage.querySelectorAll('.q-btn');
            quickBtns.forEach(btn => {
                const text = btn.textContent.toLowerCase();
                btn.style.display = text.includes(filter) ? '' : 'none';
            });
        }

        function initCharts() {
            new Chart(document.getElementById('lettersBarChart'), {
                type: 'bar',
                data: {
                    labels: ['July', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'Letters',
                        data: [450, 520, 480, 610, 590, 720],
                        backgroundColor: '#3b82f6',
                        borderRadius: 5
                    }]
                },
                options: { responsive: true, plugins: { legend: { display: false } } }
            });

            new Chart(document.getElementById('trendLineChart'), {
                type: 'line',
                data: {
                    labels: ['W1', 'W2', 'W3', 'W4', 'W5'],
                    datasets: [{
                        label: 'Letters',
                        data: [15, 30, 25, 45, 60],
                        borderColor: '#3b82f6',
                        tension: 0.4
                    }, {
                        label: 'Complaints',
                        data: [5, 10, 8, 15, 20],
                        borderColor: '#ef4444',
                        tension: 0.4
                    }]
                }
            });

            new Chart(document.getElementById('solutionsPieChart'), {
                type: 'pie',
                data: {
                    labels: ['Resolved', 'In Progress', 'Pending'],
                    datasets: [{
                        data: [65, 20, 15],
                        backgroundColor: ['#10b981', '#f59e0b', '#ef4444']
                    }]
                }
            });
        }

        // --- EXPANDED DATA CONTENT (WITH INDIAN NAMES & CURRENCY) ---
        const draftData = [
            {
                summary: "This draft reply is formulated in response to the Ministry of Finance's inquiry regarding the projected budget shortfall for Q4 2024. \n\nIt specifically addresses: \n1. The unexpected rise in raw material costs for the Metro Phase 2 project (approx. 15% increase). \n2. The reallocation of funds from the 'Events & Marketing' sector to cover critical infrastructure repairs. \n3. A request for an emergency grant of 4 Crores to ensure project completion by the fiscal year-end. \n\nThe document includes attached ledgers from the Audit Department verifying these claims.",
                body: "To: The Under Secretary, Ministry of Finance\nSubject: Clarification on Budget Allocation & Shortfall Projection (Ref: DRY-2024-1456)\n\nRespected Sir/Madam,\n\nWith reference to your letter dated 1st December 2024, asking for clarification regarding the projected deficit in the Public Works account, we submit the following details.\n\nOur primary focus for this fiscal quarter has been the accelerated completion of the Metro Phase 2 extension. However, due to market fluctuations, the cost of steel and cement has risen by approximately 15% since our initial budget filing in January. This has created an unforeseen gap of 2.5 Crores in our capital expenditure.\n\nTo mitigate this, the department has already diverted 20% of the non-essential marketing budget towards this project. Despite these internal adjustments, a shortfall remains. We strictly adhere to the fiscal responsibility guidelines and assure you that no funds have been misappropriated.\n\nWe kindly request you to review the attached audit report and consider our application for the supplementary grant.\n\nYours Faithfully,\nArjun Mehta\nAdministrator, Nexus Secretariat.",
                ai: "\"I've analyzed the draft. It is strong, but I recommend a slight tone shift in the second paragraph. \n\nInstead of 'unforeseen gap', consider using 'market-driven cost variance' to sound more analytical. \n\nAdditionally, explicitly mentioning the 'State Public Works Manual, Section 4' in the final paragraph would strengthen your legal standing for the grant request. \n\nShall I apply these enhancements for you?\""
            },
            {
                summary: "This is a formal response to Citizen Complaint #CMP-2024-032 filed by Mrs. Kavita Reddy regarding the deteriorating condition of Main Street. \n\nThe summary validates the citizen's concern, confirming that inspection team 'Alpha-1' visited the site on Dec 6th. \n\nIt identifies the root cause as 'heavy rain damage' combined with 'contractor delay'. It outlines the immediate deployment of a repair crew and provides a transparent timeline for fix completion, along with a direct tracking number for the citizen.",
                body: "Dear Mrs. Kavita Reddy,\n\nThank you for reaching out to the Nexus Office Management System regarding the infrastructure issues on M.G. Road (Ref: CMP-2024-032).\n\nWe sincerely apologize for the inconvenience caused to you and the local residents. Following your complaint, we dispatched our Quality Control Officer, Mr. Suresh Patil, to inspect the location yesterday. His report confirms significant pothole formation due to the recent unseasonal rains.\n\nWe have issued an urgent work order to our contractor, 'Omkar Infrastructure Ltd', under Work Order #889. The repair work is scheduled to commence tomorrow morning, December 8th, and is expected to be completed within 48 hours, barring severe weather conditions.\n\nYou can track the live status of this repair using the Ticket ID: RPR-9982 on our public portal. Thank you for being a vigilant citizen.\n\nRegards,\nPublic Grievance Cell.",
                ai: "\"The empathy in the opening is excellent. \n\nHowever, to prevent further follow-ups, I suggest adding a sentence about the 'Defect Liability Period' of the repair work. \n\nFor example: 'Please note that these repairs come with a 6-month guarantee period.' \n\nThis adds a layer of assurance and professionalism to the response.\""
            },
            {
                summary: "This draft serves as the internal cover letter for the 'Annual Departmental Performance Report 2024'. \n\nIt summarizes key victories: \n1. A 12% increase in case resolution speed due to the new AI integration. \n2. A 5% reduction in operational costs (saving 85 Lakhs annually). \n3. High employee satisfaction scores (4.8/5). \n\nIt seeks final approval from the Director before the report is published to the public domain and shared with the Municipal Corporation.",
                body: "Memorandum\nTo: The Director of Operations\nFrom: Administrative Desk\nDate: December 7, 2024\nSubject: Approval for Annual Performance Report 2024 (Ref: DRY-2024-1450)\n\nPlease find attached the finalized draft of the Annual Report for the fiscal year 2024. The data reveals a highly successful year for the department.\n\nKey Highlights for the Executive Summary:\n1. Operational Efficiency: The implementation of the Nexus System has reduced average file processing time from 3 days to 1.2 days.\n2. Financial Health: We have achieved a surplus of 5% in the administrative budget through rigorous vendor renegotiation.\n3. Human Resources: Employee retention is at an all-time high of 98%.\n\nWe request your signature on Page 4 to authorize the release of this document to the Municipal Corporation by Monday.\n\nRegards,\nArjun Mehta.",
                ai: "\"The draft is concise and data-driven. \n\nHowever, I noticed you didn't highlight the 'Digital India Initiative' metrics (paperless workflow savings). \n\nIncluding that data point would align perfectly with the Central Government's new mandates. \n\nI can insert a bullet point about 'Saving 50,000 sheets of paper' if you wish.\""
            }
        ];

        // --- TYPEWRITER EFFECT LOGIC ---
        let aiTypingTimeout; // Variable to store the timeout so we can clear it

        function typeText(element, text, index = 0) {
            // If starting fresh, clear content
            if (index === 0) element.innerHTML = "";

            if (index < text.length) {
                // Handle newlines for HTML
                let char = text.charAt(index);
                if (char === '\n') {
                    element.innerHTML += '<br>';
                } else {
                    element.innerHTML += char;
                }

                // Randomize speed slightly for realistic typing effect (10ms to 30ms)
                const randomSpeed = Math.floor(Math.random() * 20) + 10;

                aiTypingTimeout = setTimeout(() => typeText(element, text, index + 1), randomSpeed);
            }
        }

        function loadDraft(index, element) {
            // UI Active State
            document.querySelectorAll('#drafts-view .draft-item').forEach(item => item.classList.remove('active'));
            element.classList.add('active');

            // Update Static Content (Instant load)
            document.getElementById('draft-summary').innerText = draftData[index].summary;
            document.getElementById('draft-body').innerText = draftData[index].body;

            // Update AI Content (Typewriter Effect)
            // 1. Clear any existing typing timeout
            clearTimeout(aiTypingTimeout);

            // 2. Get the element and start typing
            const aiBox = document.getElementById('ai-suggestion');
            typeText(aiBox, draftData[index].ai);
        }

        // FORWARD PAGE LOGIC
        let currentSelectedLetter = "";
        let currentSelectedProfile = "";

        function selectLetter(id, subject, element) {
            const container = element.parentElement;
            container.querySelectorAll('.draft-item').forEach(item => item.classList.remove('active'));
            element.classList.add('active');
            currentSelectedLetter = `${id}: ${subject}`;
            document.getElementById('selected-letter-text').innerText = currentSelectedLetter;
        }

        function selectProfile(name, role, initials, element) {
            const container = element.parentElement;
            container.querySelectorAll('.draft-item').forEach(item => item.classList.remove('active'));
            element.classList.add('active');
            currentSelectedProfile = `${name} (${role})`;
            document.getElementById('selected-profile-text').innerText = currentSelectedProfile;
        }

        function confirmForward() {
            if (!currentSelectedLetter || !currentSelectedProfile) {
                alert("Please select both a letter and a profile to forward.");
                return;
            }
            alert(`Letter "${currentSelectedLetter}" successfully forwarded to ${currentSelectedProfile}`);
            showPage('dashboard-view');
        }

        document.addEventListener('DOMContentLoaded', function () {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = 1;
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.stat-card, .glass-panel, .ai-card, .draft-big-card').forEach(el => {
                observer.observe(el);
            });
        });
    </script>
</body>

</html>